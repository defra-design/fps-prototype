<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMD User</title>
     <link rel="stylesheet" href="../css/bootstrap.min.css">	
    <link href="https://getbootstrap.com/docs/5.2/assets/css/docs.css" rel="stylesheet" />
   
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
   <link rel="stylesheet" href="../css/pims_style/style.css" />
    <!-- <link href="https://cdn.jsdelivr.net/npm/tom-select/dist/css/tom-select.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/tom-select/dist/js/tom-select.complete.min.js"></script> -->
    <style>
        .table.equal td,
        .table.equal th {
            width: 1%;
        }

        .equal-table {
            table-layout: fixed;
            width: 100%;
        }

        .thead-light>tr>th:nth-child(7) {
            width: 20%;
        }

        
.main-nav {
    display: flex;
    background-color: #1d70b8;
    padding: 0;
    margin: 0;
    /* box-shadow: 0 2px 4px rgba(0,0,0,0.1); */
}  
.nav-item {
    position: relative;
    display: flex;
}

.nav-button {
    background-color: #1d70b8;
    color: white;
    border: none;
    padding: 12px 20px 12px 20px;
    cursor: pointer;
    font-size: 14px;
    white-space: nowrap;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: background-color 0.2s ease;
    border-right: 1px solid rgba(255,255,255,0.2);
}

.nav-button:hover {
    background-color: #003078;
}

.nav-button.active {
    background-color: #357abd;
}

.nav-button:focus {
    background: #003078;
}


.dropdown-toggle::after {
    display: none;
	}
    </style>
     <link rel="stylesheet" href="../css/main_style.css">
</head>

<body>
    <header>
        <div class="header-nav">

            <div class="pims-log-wrapper">
                <div>
                    <img src="../images/defra_logo.png" width="80px" />
                </div>
                <!-- <div class="menu-icon" onclick="openNav()">
                    <div class="bar1"></div>
                    <div class="bar2"></div>
                    <div class="bar3"></div>
                </div> -->
                <div class="pims-log">
                    <span>PIMS</span>
                </div>
                <p>Project Information Management System</p>
            </div>
             <div class="btn-group" style=" display: flex; align-items: center; font-size:16px;">
                Meg Ved 
				
				<button type="button" aria-label="user dropdown arrow to go home page" style="border: 0;" class="btn btn-secondary dropdown-toggle user-menu" data-bs-toggle="dropdown" aria-expanded="false">
                   <img src="../images/circle-user-regular-full.svg" alt="user icon" width="24"> <img src="../images/down-arrow.png" alt="dropdown arrow for logout of application" width="30px" height="30px">
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                    <!-- <li><button class="dropdown-item" type="button"><i class="fa-regular fa-user"></i> Profile</button>
                    </li>
                    <li><button class="dropdown-item" type="button"><i class="fa-solid fa-gear"></i> Settings</button>
                    </li> -->
                    <li><a href="../index.html" class="dropdown-item" type="button">
                       <img src="../images/house-user-solid-full.svg" alt="dropdown home icon" width="22px">
                            Home</a></li>
                </ul>
            </div>
        </div>
    </header>
    <nav class="main-nav">
       <div class="nav-item dropdown">
            <a class="nav-link" href="pimshome.html" style="text-decoration: none;">
               Choose Project
            </a>
        </div>
         <div class="nav-item dropdown">
            <a class="nav-button" href="#" style="text-decoration: none;">
               Print Reports 
            </a>
        </div>
		 <div class="nav-item dropdown">
            <a class="nav-button" href="#" style="text-decoration: none;">
               Publications 
            </a>
        </div>
		 <div class="nav-item dropdown">
            <a class="nav-button" href="#" style="text-decoration: none;">
               Maintenance 
            </a>
        </div>
		 <div class="nav-item dropdown">
            <a class="nav-button" href="#" style="text-decoration: none;">
               Pop-up Data Check 
            </a>
        </div>
    </nav>
     <div class="container-fluid" style="padding: 0;">
                <h5 style="padding: 10px 0 5px 20px; border-bottom: 2px solid #1d70b8; margin-bottom: 10px; display: flex; justify-content: space-between;">Milestone List <div style="margin-right: 16px;"><a href="pimshome.html" class="btn btn-outline-primary btn-sm">Back</a></div></h5>
     </div>
    <div class="d-flex">
         <nav class="sidebar d-flex flex-column flex-shrink-0 position-fixedX">
            <button class="toggle-btn" onclick="toggleSidebar()">
                <i class="fas fa-chevron-left"></i>
            </button>

            <div class="nav flex-column">
                 <!-- <a href="index.html" class="sidebar-link text-decoration-none p-3">
                    <i class="fa-solid fa-house-user me-3" style="color: #ffffff;"></i>
                    <span class="hide-on-collapse">Home</span>
                </a> -->
				 <a href="selectedprojectdetails.html" class="sidebar-link text-decoration-none p-3">
				  <i class="fa-solid fa-list-check me-3"></i>
                   
                    <span class="hide-on-collapse">Project Details</span>
                </a>
				
                <a href="#" class="sidebar-link text-decoration-none p-3">
                    <i class="fas fa-chart-bar me-3"></i>
                    <span class="hide-on-collapse">Yearly Financial Details</span>
                </a>
                <a href="#" class="sidebar-link text-decoration-none p-3">
                    <i class="fas fa-users me-3"></i>
                    <span class="hide-on-collapse">A&F Report Data</span>
                </a>

                <a href="#" class="sidebar-link text-decoration-none p-3">
                    <i class="fas fa-box me-3"></i>
                    <span class="hide-on-collapse">Milestones</span>
                </a>
                <a href="yearlyfinance.html" class="sidebar-link text-decoration-none p-3">
                    <i class="fa-solid fa-sack-dollar me-3" style="color: #ffffff;"></i>
                    <span class="hide-on-collapse">Yearly Finances</span>
                </a>
                <a href="#" class="sidebar-link text-decoration-none p-3">
                    <i class="fa-solid fa-file-invoice-dollar me-3" style="color: #ffffff;"></i>
                    <span class="hide-on-collapse">Invoices</span>
                </a>
                <a href="#" class="sidebar-link text-decoration-none p-3">
                    <i class="fa-regular fa-message me-3"></i>
                    <span class="hide-on-collapse">Comments</span>
                </a>

                <!-- <div class="menu-section">
                    <div class="menu-item sidebar-link active text-decoration-none p-3"
                        onclick="toggleSubmenu('project-maintenance')"
                        style="display: flex;flex-wrap: nowrap;flex-direction: row; align-items: center;">
                        <i class="fa-regular fa-user me-3"></i>
                        <span class="hide-on-collapse">PMD User</span>
                        <span class="arrow"><i class="fa-solid fa-angle-down"></i></span>
                    </div>
                    <div class="submenu" id="project-maintenance">
                        <div class="submenu-item"><a href="pmduser.html" alt="project maintenance"> Milestone List</a></div>
                        <div class="submenu-item"><a href="pmduser.html" alt="project maintenance"> Milestone update</a></div> 
                    </div>
                </div> -->

                <a href="#" class="sidebar-link text-decoration-none p-3">
                    <i class="fa-solid fa-list-check me-3"></i>
                    <span class="hide-on-collapse"> Project Review </span>
                </a>

              

              

                <a href="pmduser.html" class="sidebar-link text-decoration-none p-3">
                    <i class="fa-solid fa-user-tie me-3" style="color: #ffffff;"></i>
                    <span class="hide-on-collapse">PMD Milestone</span>
                </a>


            </div>
        </nav>
        <main class="main-content" style="height: 800px; padding-top: 0;">
            <!-- <div>
                <h5 style="padding: 0px 0 15px 0px;
    border-bottom: 2px solid #1d70b8;
    margin-bottom: 10px;
    margin-left: 3px">Milestone List</h5>
            </div> -->
            <div class="container-fluid" style="padding-left: 0;">
                <div style="border: 1px solid #ccc;border-radius: 10px 10px 0 0;padding: 0 10px 10px 10px;">
                    <label for="dpprojectcode" class="col-form-label">Projects</label>
                    <div class="col-2">
                        <select class="form-select" id="dpprojectcode">
                            <option value="">select project</option>
                            <option value="ABOG0508">ABOG0508</option>
                            <option value="ABOG0509">ABOG0509</option>
                            <option value="ABOG0510">ABOG0510</option>
                        </select>
                    </div>
                </div>
                <table class="table tbl-border table table-bordered equal-table">
                    <thead class="thead-light">
                        <tr>
                            <th>Milestone</th>
                            <th>Description</th>
                            <th>Date Due</th>
                            <th>On Target</th>
                            <th>Under Review</th>
                            <th>Date Completed</th>
                            <th>Project Leaders comment</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2023</td>
                            <td>Sample topic information goes here</td>
                            <td>20/11/2025</td>
                            <td>No</td>
                            <td>No</td>
                            <td>08/11/2025</td>
                            <td>User commented from PMD</td>
                            <td><button class="btn btn-primary btn-sm" id="btneditmilestone">Edit</button>

                            </td>
                        </tr>

                    </tbody>
                </table>
                <div>
                    <p>
Milestone updates are required for the following periods: April to June,
July to Sept, Oct to Dec, Jan, Feb, Mar in each financial year.<br/>
Please indicate whether a milestone is on target (even if not yet due) with either "Yes" or "No". A milestone that has passed its due date cannot be classified as "On Target".<br/>
Comments should be added to the "Milestone Comments" section if a milestone is logged as "Off Target". The comments should state the reason why the milestone is off target and any action taken to remedy the situation.<br/>
Note: the monthly project report on IntraVet will not update automatically. changes will show on the report for the next month.
                    </p>
                </div>
            </div>
        </main>
    </div>
    <div class="footer">
       &copy; Copyright Defra 2025
    </div>
    <!-- <script src="js/script.js"></script> -->
	 <script src="../js/bootstrap.bundle.min.js">  </script>
    <script>

        let editmilestonebtn = document.getElementById('btneditmilestone');
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const menu = document.querySelector('.menu-section .menu-item');
            const arrow = document.querySelector('.menu-section .menu-item > span.arrow')
            //let nextspan = document.querySelector('.menu-section .menu-item > span').nextElementSibling;

            sidebar.classList.toggle('collapsed');
            // if (arrow !== null) {
            //     //  nextspan.classList.remove('arrow'); 
            //     arrow.classList.remove('arrow');
            // } else {
            //     nextspan.classList.add('arrow');
            // }
            // ar.classList.toggle('arrow'); 
        }

        function toggleSubmenu(submenuId) {
            const submenu = document.getElementById(submenuId);
            const menuItem = submenu.previousElementSibling;

            // Close all other submenus
            const allSubmenus = document.querySelectorAll('.submenu');
            const allMenuItems = document.querySelectorAll('.menu-item');

            allSubmenus.forEach(menu => {
                if (menu.id !== submenuId) {
                    menu.classList.remove('open');
                }
            });

            allMenuItems.forEach(item => {
                if (item !== menuItem) {
                    item.classList.remove('active');
                }
            });

            // Toggle current submenu
            submenu.classList.toggle('open');
            menuItem.classList.toggle('active');
        }

        let selectedprojectcode = '';

        document.getElementById('dpprojectcode').addEventListener('change', function (e) {
            selectedprojectcode = e.target.value;
        })

        editmilestonebtn.addEventListener("click", e => {
            //if (e.target.classList.contains("viewLink")) {
            e.preventDefault();

            let tds = editmilestonebtn.closest('tr').querySelectorAll('td');

            //  {"projectcode":"ABOG0508","milestone":"00/01","description":"UI test","datedue":"2025-12-05","comment":"comment goes here"}

            const obj = {
                projectcode: selectedprojectcode,
                description: tds[1].textContent.trim(),
                milestone: tds[0].textContent.trim(),
                datecompleted: tds[5].textContent.trim(),
                datedue: tds[2].textContent.trim(),
                comment: tds[6].textContent.trim()
            };

            // Convert to base64-safe data-obj
            editmilestonebtn.dataset.obj = btoa(JSON.stringify(obj));

            console.log(obj);


            const json = e.target.getAttribute("data-obj");
            const encoded = json; // convert to Base64

            window.location.href = "pmduserdetails.html?data=" + encoded;
            //}
        });

        const openMenu = localStorage.getItem("openMenu");
        if (openMenu) {
            const submenu = document.getElementById("project-maintenance");
            if (submenu) {
                submenu.classList.add("open");
                submenu.previousElementSibling.classList.remove('active')

            }
        }
    </script>
</body>

</html>