<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inpatient Search API - User Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        h2 {
            color: #2c3e50;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-left: 10px;
            border-left: 4px solid #3498db;
        }

        h3 {
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .endpoint {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .http-method {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 14px;
            margin-right: 10px;
        }

        .get {
            background-color: #61affe;
            color: white;
        }

        .post {
            background-color: #49cc90;
            color: white;
        }

        .route {
            display: inline-block;
            font-family: 'Courier New', monospace;
            background-color: #f4f4f4;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }

        .code-block {
            background-color: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .json {
            color: #98c379;
        }

        .string {
            color: #e06c75;
        }

        .number {
            color: #d19a66;
        }

        .keyword {
            color: #c678dd;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th {
            background-color: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .status-code {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 12px;
        }

        .status-200 {
            background-color: #d4edda;
            color: #155724;
        }

        .status-400 {
            background-color: #fff3cd;
            color: #856404;
        }

        .status-404 {
            background-color: #f8d7da;
            color: #721c24;
        }

        .status-500 {
            background-color: #f8d7da;
            color: #721c24;
        }

        .note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
        }

        .info {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
        }

        .parameter {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }

        .parameter strong {
            color: #495057;
        }

        ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        li {
            margin-bottom: 8px;
        }

        .toc {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
        }

        .toc ul {
            list-style-type: none;
            margin-left: 0;
        }

        .toc li {
            margin-bottom: 10px;
        }

        .toc a {
            color: #3498db;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .example-title {
            font-weight: bold;
            color: #2c3e50;
            margin-top: 15px;
            margin-bottom: 10px;
        }

        .curl-command {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè• Inpatient Search API - User Guide</h1>
        
        <div class="info">
            <strong>Base URL:</strong> <code>https://your-api-domain.com/api/InpatientSearch</code><br>
            <strong>Version:</strong> 1.0<br>
            <strong>Content-Type:</strong> application/json
        </div>

        <div class="toc">
            <h2 style="margin-top: 0; border: none;">Table of Contents</h2>
            <ul>
                <li><a href="#overview">1. Overview</a></li>
                <li><a href="#authentication">2. Authentication</a></li>
                <li><a href="#endpoints">3. API Endpoints</a>
                    <ul style="margin-left: 20px;">
                        <li><a href="#get-all">3.1 Get All Inpatients</a></li>
                        <li><a href="#search">3.2 Search Inpatients</a></li>
                        <li><a href="#get-by-id">3.3 Get Inpatient by ID</a></li>
                    </ul>
                </li>
                <li><a href="#error-handling">4. Error Handling</a></li>
                <li><a href="#examples">5. Complete Examples</a></li>
            </ul>
        </div>

        <h2 id="overview">1. Overview</h2>
        <p>
            The Inpatient Search API provides REST endpoints for managing and searching hospital inpatient records. 
            This API modernizes the legacy VB6 form functionality, implementing search operations and data retrieval 
            for inpatient management systems.
        </p>

        <h3>Key Features:</h3>
        <ul>
            <li>Retrieve all inpatient records</li>
            <li>Search inpatients with flexible criteria (7 search types)</li>
            <li>Get specific inpatient details by ID</li>
            <li>Async/await support for optimal performance</li>
            <li>Comprehensive error handling with RFC 7807 Problem Details</li>
            <li>Cancellation token support for long-running operations</li>
        </ul>

        <h2 id="authentication">2. Authentication</h2>
        <div class="note">
            <strong>Note:</strong> Ensure you have proper authentication headers configured. Contact your system administrator 
            for API keys or authentication tokens required to access these endpoints.
        </div>

        <h2 id="endpoints">3. API Endpoints</h2>

        <!-- Endpoint 1: Get All Inpatients -->
        <div class="endpoint" id="get-all">
            <h3>
                <span class="http-method get">GET</span>
                <span class="route">/api/InpatientSearch</span>
            </h3>
            
            <p><strong>Description:</strong> Retrieves all inpatient records. Corresponds to the Form_Load data loading 
            functionality and initial DataGrid population from the legacy VB6 application.</p>

            <h4>Request Parameters</h4>
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Required</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>cancellationToken</td>
                        <td>CancellationToken</td>
                        <td>No</td>
                        <td>Optional cancellation token for async operations</td>
                    </tr>
                </tbody>
            </table>

            <h4>Response Codes</h4>
            <table>
                <thead>
                    <tr>
                        <th>Status Code</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="status-code status-200">200 OK</span></td>
                        <td>Successfully retrieved inpatient records</td>
                    </tr>
                    <tr>
                        <td><span class="status-code status-500">500 Internal Server Error</span></td>
                        <td>Server error occurred while retrieving data</td>
                    </tr>
                </tbody>
            </table>

            <div class="example-title">üìã Success Response Example (200 OK):</div>
            <div class="code-block">
<pre>[
  {
    "patientId": "P001",
    "firstName": "John",
    "lastName": "Doe",
    "admissionDate": "2024-01-15T08:30:00",
    "wardName": "ICU",
    "roomNumber": "101",
    "bedNumber": "A",
    "diagnosis": "Pneumonia",
    "doctorName": "Dr. Smith"
  },
  {
    "patientId": "P002",
    "firstName": "Jane",
    "lastName": "Smith",
    "admissionDate": "2024-01-16T10:00:00",
    "wardName": "General Ward",
    "roomNumber": "205",
    "bedNumber": "B",
    "diagnosis": "Appendicitis",
    "doctorName": "Dr. Johnson"
  }
]</pre>
            </div>

            <div class="example-title">üåê JavaScript Fetch Example:</div>
            <div class="code-block">
<pre>fetch('https://your-api-domain.com/api/InpatientSearch', {
    method: 'GET',
    headers: {
        'Accept': 'application/json',
        'Authorization': 'Bearer YOUR_TOKEN_HERE'
    }
})
.then(response => response.json())
.then(data => {
    console.log('Inpatients:', data);
})
.catch(error => {
    console.error('Error:', error);
});</pre>
            </div>

            <div class="example-title">üíª cURL Example:</div>
            <div class="curl-command">
curl -X GET "https://your-api-domain.com/api/InpatientSearch" \
     -H "Accept: application/json" \
     -H "Authorization: Bearer YOUR_TOKEN_HERE"
            </div>
        </div>

        <!-- Endpoint 2: Search Inpatients -->
        <div class="endpoint" id="search">
            <h3>
                <span class="http-method post">POST</span>
                <span class="route">/api/InpatientSearch/search</span>
            </h3>
            
            <p><strong>Description:</strong> Searches inpatients based on criteria and search text. Implements the 
            txtSearch_Change filtering logic with search types 0-6 and LIKE pattern matching from the legacy system.</p>

            <h4>Request Body</h4>
            <div class="code-block">
<pre>{
  "searchType": 0,
  "searchText": "John"
}</pre>
            </div>

            <h4>Search Types</h4>
            <table>
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Field</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>0</td>
                        <td>Patient ID</td>
                        <td>Search by patient identifier</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>First Name</td>
                        <td>Search by patient first name</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Last Name</td>
                        <td>Search by patient last name</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Ward Name</td>
                        <td>Search by ward/department name</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Room Number</td>
                        <td>Search by room number</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Bed Number</td>
                        <td>Search by bed number</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Doctor Name</td>
                        <td>Search by attending doctor name</td>
                    </tr>
                </tbody>
            </table>

            <h4>Request Parameters</h4>
            <div class="parameter">
                <strong>searchType</strong> (integer, required): The type of search to perform (0-6)
            </div>
            <div class="parameter">
                <strong>searchText</strong> (string, optional): The search query text. Supports partial matching (LIKE pattern)
            </div>

            <h4>Response Codes</h4>
            <table>
                <thead>
                    <tr>
                        <th>Status Code</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="status-code status-200">200 OK</span></td>
                        <td>Search completed successfully</td>
                    </tr>
                    <tr>
                        <td><span class="status-code status-400">400 Bad Request</span></td>
                        <td>Invalid search parameters or null request</td>
                    </tr>
                    <tr>
                        <td><span class="status-code status-500">500 Internal Server Error</span></td>
                        <td>Server error during search operation</td>
                    </tr>
                </tbody>
            </table>

            <div class="example-title">üìã Success Response Example (200 OK):</div>
            <div class="code-block">
<pre>[
  {
    "patientId": "P001",
    "firstName": "John",
    "lastName": "Doe",
    "admissionDate": "2024-01-15T08:30:00",
    "wardName": "ICU",
    "roomNumber": "101",
    "bedNumber": "A",
    "diagnosis": "Pneumonia",
    "doctorName": "Dr. Smith"
  }
]</pre>
            </div>

            <div class="example-title">‚ùå Error Response Example (400 Bad Request):</div>
            <div class="code-block">
<pre>{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.1",
  "title": "Bad Request",
  "status": 400,
  "detail": "Search request cannot be null"
}</pre>
            </div>

            <div class="example-title">üåê JavaScript Fetch Example:</div>
            <div class="code-block">
<pre>fetch('https://your-api-domain.com/api/InpatientSearch/search', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
        'Authorization': 'Bearer YOUR_TOKEN_HERE'
    },
    body: JSON.stringify({
        searchType: 1,
        searchText: 'John'
    })
})
.then(response => {
    if (!response.ok) {
        return response.json().then(err => Promise.reject(err));
    }
    return response.json();
})
.then(data => {
    console.log('Search results:', data);
})
.catch(error => {
    console.error('Error:', error);
});</pre>
            </div>

            <div class="example-title">üíª cURL Example:</div>
            <div class="curl-command">
curl -X POST "https://your-api-domain.com/api/InpatientSearch/search" \
     -H "Content-Type: application/json" \
     -H "Accept: application/json" \
     -H "Authorization: Bearer YOUR_TOKEN_HERE" \
     -d '{"searchType": 1, "searchText": "John"}'
            </div>
        </div>

        <!-- Endpoint 3: Get Inpatient by ID -->
        <div class="endpoint" id="get-by-id">
            <h3>
                <span class="http-method get">GET</span>
                <span class="route">/api/InpatientSearch/{patientId}</span>
            </h3>
            
            <p><strong>Description:</strong> Retrieves a specific inpatient by their ID. Implements the cmdApply_Click 
            functionality that validates record selection and returns selected patient data for maintenance form population.</p>

            <h4>URL Parameters</h4>
            <div class="parameter">
                <strong>patientId</strong> (string, required): The unique identifier of the patient (e.g., "P001")
            </div>

            <h4>Response Codes</h4>
            <table>
                <thead>
                    <tr>
                        <th>Status Code</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="status-code status-200">200 OK</span></td>
                        <td>Successfully retrieved inpatient details</td>
                    </tr>
                    <tr>
                        <td><span class="status-code status-400">400 Bad Request</span></td>
                        <td>Invalid or empty patient ID provided</td>
                    </tr>
                    <tr>
                        <td><span class="status-code status-404">404 Not Found</span></td>
                        <td>No inpatient found with the specified ID</td>
                    </tr>
                    <tr>
                        <td><span class="status-code status-500">500 Internal Server Error</span></td>
                        <td>Server error during retrieval</td>
                    </tr>
                </tbody>
            </table>

            <div class="example-title">üìã Success Response Example (200 OK):</div>
            <div class="code-block">
<pre>{
  "patientId": "P001",
  "firstName": "John",
  "lastName": "Doe",
  "dateOfBirth": "1985-05-15",
  "gender": "Male",
  "phoneNumber": "+1-555-0123",
  "address": "123 Main Street, City, State 12345",
  "admissionDate": "2024-01-15T08:30:00",
  "wardName": "ICU",
  "roomNumber": "101",
  "bedNumber": "A",
  "diagnosis": "Pneumonia",
  "doctorName": "Dr. Smith",
  "emergencyContact": "Jane Doe (+1-555-0456)",
  "insuranceInfo": "Blue Cross - Policy #123456"
}</pre>
            </div>

            <div class="example-title">‚ùå Error Response Example (404 Not Found):</div>
            <div class="code-block">
<pre>{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.4",
  "title": "Not Found",
  "status": 404,
  "detail": "No inpatient found with ID: P999"
}</pre>
            </div>

            <div class="example-title">üåê JavaScript Fetch Example:</div>
            <div class="code-block">
<pre>const patientId = 'P001';

fetch(`https://your-api-domain.com/api/InpatientSearch/${patientId}`, {
    method: 'GET',
    headers: {
        'Accept': 'application/json',
        'Authorization': 'Bearer YOUR_TOKEN_HERE'
    }
})
.then(response => {
    if (!response.ok) {
        if (response.status === 404) {
            throw new Error('Patient not found');
        }
        throw new Error('Error retrieving patient data');
    }
    return response.json();
})
.then(data => {
    console.log('Patient details:', data);
})
.catch(error => {
    console.error('Error:', error);
});</pre>
            </div>

            <div class="example-title">üíª cURL Example:</div>
            <div class="curl-command">
curl -X GET "https://your-api-domain.com/api/InpatientSearch/P001" \
     -H "Accept: application/json" \
     -H "Authorization: Bearer YOUR_TOKEN_HERE"
            </div>
        </div>

        <h2 id="error-handling">4. Error Handling</h2>
        <p>
            All API endpoints follow the RFC 7807 Problem Details specification for error responses. 
            Errors include detailed information to help diagnose issues.
        </p>

        <h3>Standard Error Response Format</h3>
        <div class="code-block">
<pre>{
  "type": "https://tools.ietf.org/html/rfc7231#section-6.5.1",
  "title": "Bad Request",
  "status": 400,
  "detail": "Detailed error message explaining what went wrong"
}</pre>
        </div>

        <h3>Common Error Scenarios</h3>
        <table>
            <thead>
                <tr>
                    <th>Scenario</th>
                    <th>Status Code</th>
                    <th>Response</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Null search request</td>
                    <td>400</td>
                    <td>Search request cannot be null</td>
                </tr>
                <tr>
                    <td>Invalid patient ID</td>
                    <td>400</td>
                    <td>Patient ID cannot be null or empty</td>
                </tr>
                <tr>
                    <td>Patient not found</td>
                    <td>404</td>
                    <td>No inpatient found with ID: {patientId}</td>
                </tr>
                <tr>
                    <td>Invalid search parameters</td>
                    <td>400</td>
                    <td>Invalid search parameters provided</td>
                </tr>
                <tr>
                    <td>Server error</td>
                    <td>500</td>
                    <td>An error occurred while [operation description]</td>
                </tr>
            </tbody>
        </table>

        <h2 id="examples">5. Complete Examples</h2>

        <h3>Example 1: Search for Patients by Last Name</h3>
        <div class="code-block">
<pre>// Search for all patients with last name containing "Smith"
const searchPatients = async () => {
    try {
        const response = await fetch('https://your-api-domain.com/api/InpatientSearch/search', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json',
                'Authorization': 'Bearer YOUR_TOKEN_HERE'
            },
            body: JSON.stringify({
                searchType: 2,  // Last Name
                searchText: 'Smith'
            })
        });

        if (!response.ok) {
            const error = await response.json();
            console.error('Search failed:', error.detail);
            return;
        }

        const patients = await response.json();
        console.log(`Found ${patients.length} patient(s)`);
        patients.forEach(patient => {
            console.log(`${patient.firstName} ${patient.lastName} - ${patient.wardName}`);
        });
    } catch (error) {
        console.error('Network error:', error);
    }
};

searchPatients();</pre>
        </div>

        <h3>Example 2: Get Patient Details and Display</h3>
        <div class="code-block">
<pre>// Retrieve and display complete patient information
const displayPatientDetails = async (patientId) => {
    try {
        const response = await fetch(
            `https://your-api-domain.com/api/InpatientSearch/${patientId}`,
            {
                method: 'GET',
                headers: {
                    'Accept': 'application/json',
                    'Authorization': 'Bearer YOUR_TOKEN_HERE'
                }
            }
        );

        if (!response.ok) {
            if (response.status === 404) {
                console.log('Patient not found');
                return null;
            }
            throw new Error('Failed to retrieve patient');
        }

        const patient = await response.json();
        
        // Display patient information
        console.log('=== Patient Details ===');
        console.log(`ID: ${patient.patientId}`);
        console.log(`Name: ${patient.firstName} ${patient.lastName}`);
        console.log(`Admitted: ${new Date(patient.admissionDate).toLocaleDateString()}`);
        console.log(`Ward: ${patient.wardName}`);
        console.log(`Room: ${patient.roomNumber}, Bed: ${patient.bedNumber}`);
        console.log(`Doctor: ${patient.doctorName}`);
        console.log(`Diagnosis: ${patient.diagnosis}`);
        
        return patient;
    } catch (error) {
        console.error('Error:', error.message);
        return null;
    }
};

// Usage
displayPatientDetails('P001');</pre>
        </div>

        <h3>Example 3: Search by Ward with Error Handling</h3>
        <div class="code-block">
<pre>// Complete example with comprehensive error handling
class InpatientSearchClient {
    constructor(baseUrl, authToken) {
        this.baseUrl = baseUrl;
        this.authToken = authToken;
    }

    async searchByWard(wardName) {
        const url = `${this.baseUrl}/api/InpatientSearch/search`;
        
        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                    'Authorization': `Bearer ${this.authToken}`
                },
                body: JSON.stringify({
                    searchType: 3,  // Ward Name
                    searchText: wardName
                })
            });

            const data = await response.json();

            if (!response.ok) {
                throw new Error(data.detail || 'Search failed');
            }

            return {
                success: true,
                data: data,
                count: data.length
            };
        } catch (error) {
            return {
                success: false,
                error: error.message
            };
        }
    }
}

// Usage
const client = new InpatientSearchClient(
    'https://your-api-domain.com',
    'YOUR_TOKEN_HERE'
);

const result = await client.searchByWard('ICU');
if (result.success) {
    console.log(`Found ${result.count} patients in ICU`);
    result.data.forEach(p => {
        console.log(`- ${p.firstName} ${p.lastName} (Room ${p.roomNumber})`);
    });
} else {
    console.error('Search failed:', result.error);
}</pre>
        </div>

        <div class="note">
            <strong>Best Practices:</strong>
            <ul>
                <li>Always include proper error handling for all API calls</li>
                <li>Use async/await for cleaner asynchronous code</li>
                <li>Check response status codes before processing data</li>
                <li>Implement retry logic for transient failures</li>
                <li>Cache frequently accessed data to reduce API calls</li>
                <li>Use appropriate timeouts for long-running operations</li>
                <li>Validate input data on the client side before sending requests</li>
            </ul>
        </div>

        <div class="info">
            <strong>üìû Support Information:</strong><br>
            For API access issues, technical support, or questions about this documentation, 
            please contact your system administrator or the development team.
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #dee2e6;">
        
        <p style="text-align: center; color: #6c757d; font-size: 14px;">
            <strong>Inpatient Search API v1.0</strong><br>
            Hospital Management System<br>
            Generated: February 4, 2026
        </p>
    </div>
</body>
</html>